test_that("FDate sequencing", {
	expect_equal(length(seq(as.FDate("2000-01-01"),as.FDate("2004-01-00"))), 366L+365L+365L+365L)
	expect_equal(length(seq.FDate("2001-01-01","2003-12-31")), 365L+365L+365L)
	expect_equal(seq(as.FDate(20000101L), "2000-02-29", by=7L), as.FDate(c("2000-01-01","2000-01-08","2000-01-15","2000-01-22","2000-01-29","2000-02-05","2000-02-12","2000-02-19","2000-02-26")))
	expect_equal(seq(as.FDate(20000101L), "2000-02-29", by=7L, from.last=TRUE), as.FDate(c("2000-01-04","2000-01-11","2000-01-18","2000-01-25","2000-02-01","2000-02-08","2000-02-15","2000-02-22","2000-02-29")))
	expect_equal(seq(as.FDate("2000-02-29"), 20000222L), as.FDate(c("2000-02-29","2000-2-28","2000-2-27","2000-2-26","2000-02-25","2000/02/24","2000-02-23","2000/02/22")))

	expect_equal(seq.FDate("2000-01-01","2000-12-23",by="1M"), as.FDate(c(20000101L, 20000201L, 20000301L, 20000401L, 20000501L, 20000601L, 20000701L, 20000801L, 20000901L, 20001001L, 20001101L, 20001201L)))
	expect_equal(seq.FDate("2000-01-01","2000-12-23",by="-1M"), as.FDate(integer(0)))
	expect_equal(seq.FDate("2000-12-23","2000-01-01",by="1M"), as.FDate(integer(0)))
	expect_equal(seq.FDate("2000-12-31","2000-01-01",by="-1M"), as.FDate(c(20001231L, 20001131L, 20001031L, 20000931L, 20000831L, 20000731L, 20000631L, 20000531L, 20000431L, 20000331L, 20000231L, 20000131L)))
	expect_equal(format(seq.FDate("2000-12-31","2000-01-01",by="-1M")), c("2000-12-31","2000-11-30","2000-10-31","2000-09-30","2000-08-31","2000-07-31","2000-06-30","2000-05-31","2000-04-30","2000-03-31","2000-02-29","2000-01-31"))
})

if (FALSE) {
cat("+ FDate\n")
print(seq(as.FDate(20000101L), "2000-02-29"))
print(seq(as.FDate(20000101L), "2000-02-29", by=7L))
print(seq(as.FDate("2000-02-29"), 20000101L))
print("")
print(seq.FDate("2000-01-01","2000-12-23",by="1M"))
print(seq.FDate("2000-01-01","2000-12-23",by="-1M"))
print(seq.FDate("2000-12-23","2000-01-01",by="1M"))
print(seq.FDate("2000-12-23","2000-01-01",by="-1M"))

print("")
print(seq(as.FDate(20000101L), "2000-02-29", from.last=T))
print(seq(as.FDate(20000101L), "2000-02-29", by=7L, from.last=T))
print(seq(as.FDate("2000-02-29"), 20000101L, from.last=T))
print("")
print(seq.FDate("2000-01-01","2000-12-23",by="1M", from.last=T))
print(seq.FDate("2000-01-01","2000-12-23",by="-1M", from.last=T))
print(seq.FDate("2000-12-23","2000-01-01",by="1M", from.last=T))
print(seq.FDate("2000-12-23","2000-01-01",by="-1M", from.last=T))
print("")
print(seq(as.FDate("2000-A"), as.FDate("2019-01-01"), ddur("1Y")))
print(seq(as.FDate("2000-S1"), as.FDate("2019-01-01"), ddur("6M")))
print(seq(as.FDate("2000-Q4"), as.FDate("2019-01-01"), ddur("6M")))
print(seq(as.FDate("2000-2"), as.FDate("2019-01-01"), ddur("1M")))
print("")
print(seq(as.FDate("2000-A"), as.FDate("2019-01-01"), ddur("1Y"), from.last=T))
print(seq(as.FDate("2000-S1"), as.FDate("2019-01-01"), ddur("6M"), from.last=T))
print(seq(as.FDate("2000-Q4"), as.FDate("2019-01-01"), ddur("6M"), from.last=T))
print(seq(as.FDate("2000-2"), as.FDate("2019-01-01"), ddur("1M"), from.last=T))
print("auto-by")
print(seq(as.FDate("2000-A"), as.FDate("2004-A")))
print(seq(as.FDate("2000-S1"), as.FDate("2004-S2")))
print(seq(as.FDate("2000-Q1"), as.FDate("2001-Q4")))
print(seq(as.FDate("2000-01"), as.FDate("2000-12")))
print("should error")
try(print(seq(as.FDate("2000-A"), as.FDate("2019-01-01"), ddur("2M"))))
try(print(seq(as.FDate("2000-S1"), as.FDate("2019-01-01"), ddur("2M"))))
try(print(seq(as.FDate("2000-Q4"), as.FDate("2019-01-01"), ddur("2M"))))
try(print(seq(as.FDate("2000-2"), as.FDate("2019-01-01"), ddur("1M15D"))))
}